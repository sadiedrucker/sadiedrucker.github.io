{"title":"Bill length in male vs female penguins","markdown":{"yaml":{"title":"Bill length in male vs female penguins","format":{"html":{"code-fold":true}},"execute":{"message":false,"warning":false,"echo":true}},"headingText":"Background","containsRefs":false,"markdown":"\n\n\nThis simulation study investigates whether there is a statistically significant difference in bill length between male and female penguins, testing the alternative hypothesis that bill length varies by sex. he analysis uses data from the *palmerpenguins* dataset in R, which contains morphological measurements for three penguin species from the Palmer Archipelago in Antarctica. Understanding differences in bill length across sexes can provide insights into sexual dimorphism and ecological adaptations in penguin species. A permutation test was conducted to simulate the distribution of mean differences under the null hypothesis that bill length is independent of sex, allowing for an assessment of whether the observed difference is more likely due to random chance.\n\n## Visualization of variables of interest\n\n```{r}\n#| fig-alt: \"A boxplot comparing bill length between male and female penguins in the sample. Male penguins show a higher median bill length and a slightly wider spread than females.\"\n\nlibrary(tidyverse)\nlibrary(palmerpenguins)\nlibrary(ggplot2)\n\nclean_penguins <- penguins |>\n  filter(!is.na(bill_length_mm), !is.na(sex))\n\nggplot(clean_penguins, aes(x=sex, y=bill_length_mm, fill=sex))+\n  geom_boxplot()+\n    labs(\n      title = \"Bill length in male vs female penguins\" , \n      x= \"Sex\",\n      y= \"Bill length in mm\"\n      )+\n  theme_minimal()\n\n\n\n```\n\nIn the original data presented in the above graph, male penguins have a greater median bill length. To reject the null hypothesis, we performed a permutation test to determine whether this observed difference between sexes is likely to have occurred by chance.\n\n## Permutation Test\n\n### Step 1: Define the null hypothesis\n\nIn this case, the null hypothesis is that bill length is independent of sex in penguins.\n\n### Step 3: Permute (shuffle) the variable labels\n\nThis forces the null hypothesis to be true.\n\n### Step 3: Compute the observed test statistic on the null sampling distribution.\n\nWe do this by computing the mean and median differences between the sexes. I created a function called *`perm_data()`*. This function keeps track of the current replication number, *rep*, and the data set containing *`sex`* and *`bill_length_mm.`*The function mutates the data set to add a column called *`sex_perm.`* that randomly shuffles the sex labels. This action simulates the null hypothesis.\n\nThe mapping function quickly tests if the function is working as expected.\n\n## \n\n```{r, cache=TRUE}\n#Permutation test \n\nset.seed(47) \n\nperm_data <- function(rep, data){\n  data |> \n    select(sex, bill_length_mm) |> \n    mutate(sex_perm = sample(sex, replace = FALSE)) |>\n    summarize(\n      obs_ave_diff = mean(bill_length_mm[sex == \"male\"], na.rm = TRUE) - \n                     mean(bill_length_mm[sex == \"female\"], na.rm = TRUE),\n      obs_median_diff = median(bill_length_mm[sex == \"male\"], na.rm = TRUE) - \n                        median(bill_length_mm[sex == \"female\"], na.rm = TRUE),\n      perm_ave_diff = mean(bill_length_mm[sex_perm == \"male\"], na.rm = TRUE) - \n                      mean(bill_length_mm[sex_perm == \"female\"], na.rm = TRUE),\n      perm_median_diff = median(bill_length_mm[sex_perm == \"male\"], na.rm = TRUE) - \n                         median(bill_length_mm[sex_perm == \"female\"], na.rm = TRUE),\n              rep = rep)\n}\n  \nmap(c(1:10), perm_data, data = clean_penguins) |> \n  list_rbind()\n```\n\n### Step 4: Visualize null sampling distributions\n\nThe mapping function used here runs the function *`perm_data()`* one thousand times to simulate the permutation distribution.\n\nEach row in *`perm_stats`* represents one shuffled permutation: the permuted mean and median differences and the observed statistics.\n\n```{r, cache=TRUE}\n#| fig-alt: \"A histogram showing the permutation-based null distribution of mean bill-length differences between sexes, centered around zero. A vertical red line marks the observed mean difference from the sample, which lies far outside of most of the distribution.\"\nset.seed(47)\nperm_stats <- \n  map(c(1:1000), perm_data, data = clean_penguins) |> \n  list_rbind() \n\nperm_stats |> \n  ggplot(aes(x = perm_ave_diff)) + \n  geom_histogram() + \n  geom_vline(aes(xintercept = obs_ave_diff), color = \"red\")+\n  labs(\n    title=\"Mean null sampling distributions \"\n  )\n\n```\n\n```{r}\n\"A histogram showing the permutation-based null distribution of median bill-length differences between sexes, centered around zero. A vertical red line marks the observed median difference from the sample, which is at the tail end of the distribution.\"\nperm_stats |> \n  ggplot(aes(x = perm_median_diff)) + \n  geom_histogram() + \n  geom_vline(aes(xintercept = obs_median_diff), color = \"red\")+\n   labs(\n    title=\"Median null sampling distributions \"\n  )\n```\n\n### Step 5: Compute the p-value\n\nThis value indicates the probability of observing the data or more extreme outcomes if the null hypothesis is true. In other words, the probability that the pattern in the original observed data is due to random chance.\n\n```{r}\n\n perm_stats |> \n  summarize(\n    p_val_ave = (sum(abs(perm_ave_diff) >= abs(obs_ave_diff[1])) + 1) / (n() + 1),\n    p_val_median = (sum(abs(perm_median_diff) >= abs(obs_median_diff[1])) + 1) / (n() + 1)\n  ) \n```\n\n## Conclusion\n\nThe permutation test provides strong evidence that male and female penguins have different bill lengths. Both the mean and median differences are far outside the distribution expected under the null hypothesis of no difference. The extremely small p-values (p ≈ 0.001) indicate that the observed differences are highly unlikely to have occurred by random chance, confirming significant sexual dimorphism in bill length.\n","srcMarkdownNoYaml":"\n\n## Background\n\nThis simulation study investigates whether there is a statistically significant difference in bill length between male and female penguins, testing the alternative hypothesis that bill length varies by sex. he analysis uses data from the *palmerpenguins* dataset in R, which contains morphological measurements for three penguin species from the Palmer Archipelago in Antarctica. Understanding differences in bill length across sexes can provide insights into sexual dimorphism and ecological adaptations in penguin species. A permutation test was conducted to simulate the distribution of mean differences under the null hypothesis that bill length is independent of sex, allowing for an assessment of whether the observed difference is more likely due to random chance.\n\n## Visualization of variables of interest\n\n```{r}\n#| fig-alt: \"A boxplot comparing bill length between male and female penguins in the sample. Male penguins show a higher median bill length and a slightly wider spread than females.\"\n\nlibrary(tidyverse)\nlibrary(palmerpenguins)\nlibrary(ggplot2)\n\nclean_penguins <- penguins |>\n  filter(!is.na(bill_length_mm), !is.na(sex))\n\nggplot(clean_penguins, aes(x=sex, y=bill_length_mm, fill=sex))+\n  geom_boxplot()+\n    labs(\n      title = \"Bill length in male vs female penguins\" , \n      x= \"Sex\",\n      y= \"Bill length in mm\"\n      )+\n  theme_minimal()\n\n\n\n```\n\nIn the original data presented in the above graph, male penguins have a greater median bill length. To reject the null hypothesis, we performed a permutation test to determine whether this observed difference between sexes is likely to have occurred by chance.\n\n## Permutation Test\n\n### Step 1: Define the null hypothesis\n\nIn this case, the null hypothesis is that bill length is independent of sex in penguins.\n\n### Step 3: Permute (shuffle) the variable labels\n\nThis forces the null hypothesis to be true.\n\n### Step 3: Compute the observed test statistic on the null sampling distribution.\n\nWe do this by computing the mean and median differences between the sexes. I created a function called *`perm_data()`*. This function keeps track of the current replication number, *rep*, and the data set containing *`sex`* and *`bill_length_mm.`*The function mutates the data set to add a column called *`sex_perm.`* that randomly shuffles the sex labels. This action simulates the null hypothesis.\n\nThe mapping function quickly tests if the function is working as expected.\n\n## \n\n```{r, cache=TRUE}\n#Permutation test \n\nset.seed(47) \n\nperm_data <- function(rep, data){\n  data |> \n    select(sex, bill_length_mm) |> \n    mutate(sex_perm = sample(sex, replace = FALSE)) |>\n    summarize(\n      obs_ave_diff = mean(bill_length_mm[sex == \"male\"], na.rm = TRUE) - \n                     mean(bill_length_mm[sex == \"female\"], na.rm = TRUE),\n      obs_median_diff = median(bill_length_mm[sex == \"male\"], na.rm = TRUE) - \n                        median(bill_length_mm[sex == \"female\"], na.rm = TRUE),\n      perm_ave_diff = mean(bill_length_mm[sex_perm == \"male\"], na.rm = TRUE) - \n                      mean(bill_length_mm[sex_perm == \"female\"], na.rm = TRUE),\n      perm_median_diff = median(bill_length_mm[sex_perm == \"male\"], na.rm = TRUE) - \n                         median(bill_length_mm[sex_perm == \"female\"], na.rm = TRUE),\n              rep = rep)\n}\n  \nmap(c(1:10), perm_data, data = clean_penguins) |> \n  list_rbind()\n```\n\n### Step 4: Visualize null sampling distributions\n\nThe mapping function used here runs the function *`perm_data()`* one thousand times to simulate the permutation distribution.\n\nEach row in *`perm_stats`* represents one shuffled permutation: the permuted mean and median differences and the observed statistics.\n\n```{r, cache=TRUE}\n#| fig-alt: \"A histogram showing the permutation-based null distribution of mean bill-length differences between sexes, centered around zero. A vertical red line marks the observed mean difference from the sample, which lies far outside of most of the distribution.\"\nset.seed(47)\nperm_stats <- \n  map(c(1:1000), perm_data, data = clean_penguins) |> \n  list_rbind() \n\nperm_stats |> \n  ggplot(aes(x = perm_ave_diff)) + \n  geom_histogram() + \n  geom_vline(aes(xintercept = obs_ave_diff), color = \"red\")+\n  labs(\n    title=\"Mean null sampling distributions \"\n  )\n\n```\n\n```{r}\n\"A histogram showing the permutation-based null distribution of median bill-length differences between sexes, centered around zero. A vertical red line marks the observed median difference from the sample, which is at the tail end of the distribution.\"\nperm_stats |> \n  ggplot(aes(x = perm_median_diff)) + \n  geom_histogram() + \n  geom_vline(aes(xintercept = obs_median_diff), color = \"red\")+\n   labs(\n    title=\"Median null sampling distributions \"\n  )\n```\n\n### Step 5: Compute the p-value\n\nThis value indicates the probability of observing the data or more extreme outcomes if the null hypothesis is true. In other words, the probability that the pattern in the original observed data is due to random chance.\n\n```{r}\n\n perm_stats |> \n  summarize(\n    p_val_ave = (sum(abs(perm_ave_diff) >= abs(obs_ave_diff[1])) + 1) / (n() + 1),\n    p_val_median = (sum(abs(perm_median_diff) >= abs(obs_median_diff[1])) + 1) / (n() + 1)\n  ) \n```\n\n## Conclusion\n\nThe permutation test provides strong evidence that male and female penguins have different bill lengths. Both the mean and median differences are far outside the distribution expected under the null hypothesis of no difference. The extremely small p-values (p ≈ 0.001) indicate that the observed differences are highly unlikely to have occurred by random chance, confirming significant sexual dimorphism in bill length.\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"message":false,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"output-file":"Permutation.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.5.57","editor":"visual","theme":"journal","page-layout":"full","favicon":"tinyBaby.png","title":"Bill length in male vs female penguins"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}