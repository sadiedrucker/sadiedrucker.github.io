{
  "hash": "1f94bd32d04edd32643584249ab1ed70",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"New York Times Headlines\"\nformat: html\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.6\n✔ forcats   1.0.0     ✔ stringr   1.6.0\n✔ ggplot2   4.0.1     ✔ tibble    3.3.0\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.2.0     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(stringr)\nlibrary(lubridate)\nlibrary(RTextTools) \n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: SparseM\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(forcats)\ndata(NYTimes)\nnyt<-as_tibble(NYTimes)\n\nnyt<-nyt |>\n  mutate(Date=as.Date(Date, format = \"%d-%b-%y\"))\n\nnyt_clean <- nyt |>\n  mutate(clean_headline=Title |>\n           str_to_lower()|>\n           str_replace_all(\"[^a-z\\\\s]\", \" \")|>\n           str_squish(),\n         year=year(Date)\n        )\n\nnyt_mentions <- nyt_clean |>\n  mutate(\n    clinton = str_detect(clean_headline, \"(?<![a-z])clinton(?![a-z])\"),\n    bush = str_detect(clean_headline, \"(?<![a-z])bush(?![a-z])\")\n  )\n\nnyt_periods <- nyt_mentions |>\n  mutate(\n    period = case_when(\n      Date >= as.Date(\"1997-01-20\") & Date < as.Date(\"2001-01-20\") ~ \"Clinton Era \n      (01/20/1997 to 01/20/2001)\",\n      Date >= as.Date(\"2001-01-20\") & Date < as.Date(\"2005-01-20\") ~ \"Bush era \n      (01/20/2001 to 01/20/2005)\",\n      TRUE ~ NA_character_\n    )\n  ) |>\n  filter(!is.na(period))\n\nnyt_counts <- nyt_periods |>\n  group_by(period) |>\n  summarise(\n    clinton_mentions = sum(clinton),\n    bush_mentions = sum(bush)\n  )\n\n  \n\nnyt_plot<-nyt_counts|>\n  pivot_longer(cols = c(clinton_mentions, bush_mentions),\n               names_to = \"name\", values_to = \"count\") \n  \n\nggplot(nyt_plot, aes(x = period, y = count, fill = name)) +\n  geom_col(position = \"dodge\") +\n  labs(\n    title = \"NYT Headline Mentions: Clinton vs Bush\",\n    x = \"Presidential Era\", \n    y = \"Number of Mentions\",\n    fill = \"President\"\n  ) +\n  scale_fill_manual(\n    values = c(\"clinton_mentions\" = \"blue\", \"bush_mentions\" = \"red\"),\n    labels = c(\"clinton_mentions\" = \"Clinton mentions\",\n               \"bush_mentions\" = \"Bush mentions\")\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](NYTHeadlines_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n\n```{.r .cell-code}\nnyt_trend <- nyt_mentions %>%\n  filter(Date >= as.Date(\"1997-01-20\") & Date < as.Date(\"2005-01-20\")) %>%\n  mutate(month = floor_date(Date, \"month\")) %>%\n  group_by(month) %>%\n  summarise(\n    clinton = sum(clinton),\n    bush    = sum(bush)\n  ) %>%\n  pivot_longer(cols = c(clinton, bush),\n               names_to = \"name\",\n               values_to = \"count\")\n\nggplot(nyt_trend, aes(x = month, y = count, color = name)) +\n  geom_line(size = 1) +\n  geom_point(size = 2) +\n  scale_x_date(date_labels = \"%b %Y\", date_breaks = \"6 months\") + \n  scale_color_manual(\n    values = c(\"clinton\" = \"blue\", \"bush\" = \"red\"),\n    labels = c(\"clinton\" = \"Clinton mentions\",\n               \"bush\" = \"Bush mentions\")) +\n  \n  labs(\n    title = \"Monthly NYT Headline Mentions: Clinton vs Bush\",\n    x = \"Month\",\n    y = \"Number of Mentions\",\n    color = \"President\"\n  ) +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1, size=8)) \n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nℹ Please use `linewidth` instead.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](NYTHeadlines_files/figure-html/unnamed-chunk-1-2.png){width=672}\n:::\n:::\n",
    "supporting": [
      "NYTHeadlines_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}